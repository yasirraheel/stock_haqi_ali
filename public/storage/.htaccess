RewriteEngine On

# Handle requests for files in storage
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]

# Set proper MIME types for common file types
<FilesMatch "\.(jpg|jpeg|png|gif|webp)$">
    Header set Content-Type "image/jpeg"
</FilesMatch>

<FilesMatch "\.(mp3|wav|ogg)$">
    Header set Content-Type "audio/mpeg"
</FilesMatch>

<FilesMatch "\.(mp4|avi|mov|wmv)$">
    Header set Content-Type "video/mp4"
</FilesMatch>

# Enable CORS for media files
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
